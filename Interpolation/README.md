# Интерполяция в Julia

В данном модуле реализованы различные методы интерполяции функций в Julia. Интерполяция - это метод построения новых точек данных в пределах диапазона дискретного набора известных точек.

## Содержание

1. [Постановка задачи](#постановка-задачи)
2. [Линейная и квадратичная интерполяция](#линейная-и-квадратичная-интерполяция)
3. [Сплайн-интерполяция](#сплайн-интерполяция)
4. [Интерполяционный полином Лагранжа](#интерполяционный-полином-лагранжа)
5. [Примеры использования](#примеры-использования)

## Постановка задачи

Задача интерполяции заключается в построении функции, проходящей через заданные точки данных. Существуют два основных типа аппроксимации:

1. **Точечная аппроксимация** - построение приближения в конечном наборе точек.
2. **Непрерывная аппроксимация** - построение приближения на всем интервале.

В модуле реализованы функции для обоих типов аппроксимации:

```julia
# Точечная аппроксимация
points = [0.0, 0.5, 1.0, 1.5, 2.0]
values = point_approximation(sin, points)

# Непрерывная аппроксимация
approx_f = continuous_approximation(sin, 0.0, π, :spline, 10)
approx_f(0.5) # Приближенное значение sin(0.5)
```

## Линейная и квадратичная интерполяция

### Линейная интерполяция

Линейная интерполяция строит прямую линию между соседними точками данных и использует её для оценки значения функции в промежуточной точке.

Для точки x на отрезке [x₁, x₂] интерполированное значение вычисляется как:
f(x) ≈ f(x₁) + (f(x₂) - f(x₁)) * (x - x₁) / (x₂ - x₁)

```julia
using Interpolation

x_points = [0.0, 1.0, 2.0, 3.0]
y_points = [0.0, 1.0, 4.0, 9.0]  # значения f(x) = x²
linear_interpolation(x_points, y_points, 1.5)  # приближенное значение f(1.5)
```

### Квадратичная интерполяция

Квадратичная интерполяция строит параболу (полином второй степени), проходящую через три ближайшие точки данных.

```julia
x_points = [0.0, 1.0, 2.0, 3.0, 4.0]
y_points = [0.0, 1.0, 4.0, 9.0, 16.0]  # значения f(x) = x²
quadratic_interpolation(x_points, y_points, 1.5)  # приближенное значение f(1.5)
```

## Сплайн-интерполяция

Сплайн-интерполяция обеспечивает гладкое приближение функций с помощью кусочно-полиномиальных функций (сплайнов). Преимущество сплайнов в том, что они обеспечивают непрерывность функции и её производных.

### Кубический сплайн

Кубический сплайн на интервале [x_i, x_{i+1}] определяется как:
S(x) = a[i] + b[i]*(x - x[i]) + c[i]*(x - x[i])^2 + d[i]*(x - x[i])^3

В модуле реализованы:
- Естественный сплайн (с нулевыми вторыми производными на концах)
- Зажатый сплайн (с заданными значениями первой производной на концах)

```julia
# Естественный сплайн
x = [0.0, 1.0, 2.0, 3.0, 4.0]
y = [0.0, 1.0, 4.0, 9.0, 16.0]  # значения f(x) = x²
spline = natural_spline(x, y)
evaluate_spline(spline, 1.5)  # значение в точке x = 1.5

# Зажатый сплайн с заданными производными на концах
spline = clamped_spline(x, y, 0.0, 8.0)  # f'(0) = 0, f'(4) = 8
```

## Интерполяционный полином Лагранжа

Интерполяционный полином Лагранжа позволяет построить полином степени n, проходящий через n+1 заданную точку. Он представляет собой линейную комбинацию базисных полиномов Лагранжа.

```julia
x_points = [0.0, 1.0, 2.0]
y_points = [1.0, 3.0, 7.0]
p = lagrange_polynomial(x_points, y_points)
p(1.5)  # значение полинома в точке x = 1.5

# Или более прямой вызов
lagrange_interpolation(x_points, y_points, 1.5)
```

### Точность интерполяции

Для оценки погрешности интерполяции можно использовать функцию `interpolation_error`:

```julia
f(x) = sin(x)
f_derivative(x) = -sin(x)  # 5-я производная sin(x) при n=4
x_points = [0.0, 0.2, 0.4, 0.6, 0.8]
error = interpolation_error(f, x_points, 0.5, f_derivative)
```

Для полинома Лагранжа степени n погрешность в точке x выражается формулой:
f(x) - p(x) = f^(n+1)(ξ) / (n+1)! * ∏_{i=0}^n (x - x_i)
где ξ - некоторая точка из интервала, содержащего все узлы и точку x.

### Узлы Чебышева

Для уменьшения эффекта Рунге и улучшения сходимости интерполяционного полинома рекомендуется использовать узлы Чебышева вместо равноотстоящих узлов:

```julia
# Узлы Чебышева на интервале [0, 1]
nodes = chebyshev_nodes(0.0, 1.0, 10)
```

## Примеры использования

### Пример 1: Интерполяция синуса

```julia
using Interpolation
using Plots

# Задаем функцию и интервал
f(x) = sin(x)
a, b = 0.0, 2π

# Создаем узлы и вычисляем значения функции
n = 10
x_equidistant = equidistant_nodes(a, b, n)
x_chebyshev = chebyshev_nodes(a, b, n)
y_equidistant = f.(x_equidistant)
y_chebyshev = f.(x_chebyshev)

# Создаем интерполяционные полиномы
p_equidistant = lagrange_polynomial(x_equidistant, y_equidistant)
p_chebyshev = lagrange_polynomial(x_chebyshev, y_chebyshev)

# Создаем точки для графика
x_plot = range(a, b, length=500)
y_plot = f.(x_plot)
y_equidistant_plot = [p_equidistant(x) for x in x_plot]
y_chebyshev_plot = [p_chebyshev(x) for x in x_plot]

# Строим график
plot(x_plot, y_plot, label="sin(x)", linewidth=2)
plot!(x_plot, y_equidistant_plot, label="Равноотстоящие узлы", linestyle=:dash)
plot!(x_plot, y_chebyshev_plot, label="Узлы Чебышева", linestyle=:dashdot)
scatter!(x_equidistant, y_equidistant, label="Точки интерполяции (равном.)")
scatter!(x_chebyshev, y_chebyshev, label="Точки интерполяции (Чебышев)")
title!("Интерполяция sin(x)")
xlabel!("x")
ylabel!("y")
```

### Пример 2: Сравнение методов интерполяции

```julia
using Interpolation
using Plots

# Задаем функцию и интервал
f(x) = 1 / (1 + 25x^2)  # Функция Рунге
a, b = -1.0, 1.0

# Создаем узлы и вычисляем значения функции
n = 10
x_points = equidistant_nodes(a, b, n)
y_points = f.(x_points)

# Создаем интерполяции разными методами
p_lagrange = lagrange_polynomial(x_points, y_points)
spline = cubic_spline(x_points, y_points)

# Создаем точки для графика
x_plot = range(a, b, length=500)
y_plot = f.(x_plot)
y_lagrange_plot = [p_lagrange(x) for x in x_plot]
y_spline_plot = [evaluate_spline(spline, x) for x in x_plot]
y_linear_plot = [linear_interpolation(x_points, y_points, x) for x in x_plot]

# Строим график
plot(x_plot, y_plot, label="f(x) = 1/(1+25x²)", linewidth=2)
plot!(x_plot, y_lagrange_plot, label="Полином Лагранжа", linestyle=:dash)
plot!(x_plot, y_spline_plot, label="Кубический сплайн", linestyle=:dashdot)
plot!(x_plot, y_linear_plot, label="Линейная интерполяция", linestyle=:dot)
scatter!(x_points, y_points, label="Точки интерполяции")
title!("Сравнение методов интерполяции")
xlabel!("x")
ylabel!("y")
```

## Дополнительные материалы

Для более глубокого изучения методов интерполяции рекомендуется ознакомиться с:

1. Документацией модуля [Interpolations.jl](https://github.com/JuliaMath/Interpolations.jl) - стандартный пакет для интерполяции в Julia
2. Книгой "Численные методы" (Бахвалов, Жидков, Кобельков)
3. [Лекциями по численным методам](https://www.youtube.com/playlist?list=PLlb7e2G7aSpT4SMpYl8nH3_QuePopMnmQ) (видеокурс) 