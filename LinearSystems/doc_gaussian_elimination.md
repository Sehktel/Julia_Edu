# Метод Гаусса для решения систем линейных уравнений

## Теоретическое введение

Метод Гаусса (или метод исключения Гаусса) – это один из основных прямых методов решения систем линейных уравнений. Метод назван в честь немецкого математика Карла Фридриха Гаусса и основан на приведении системы к ступенчатому виду с последующим обратным ходом.

Рассмотрим систему линейных уравнений в матричной форме:

```
Ax = b
```

где:
- A - матрица коэффициентов размера n×n
- x - вектор неизвестных размера n
- b - вектор правой части размера n

## Алгоритм метода Гаусса

Метод Гаусса состоит из двух основных этапов:

### 1. Прямой ход (приведение к верхнетреугольному виду)

На этом этапе мы последовательно исключаем неизвестные из уравнений, приводя матрицу A к верхнетреугольному виду. Для каждого k от 1 до n-1:

1. Для каждой строки i от k+1 до n:
   - Вычисляем множитель m = a[i,k] / a[k,k]
   - Вычитаем k-ю строку, умноженную на m, из i-й строки:
     - Для каждого j от k до n: a[i,j] = a[i,j] - m * a[k,j]
     - b[i] = b[i] - m * b[k]

### 2. Обратный ход (решение верхнетреугольной системы)

После приведения системы к верхнетреугольному виду, мы находим значения неизвестных, начиная с последней и двигаясь к первой:

1. x[n] = b[n] / a[n,n]
2. Для каждого i от n-1 до 1:
   - Вычисляем сумму: sum = 0
   - Для каждого j от i+1 до n: sum = sum + a[i,j] * x[j]
   - x[i] = (b[i] - sum) / a[i,i]

## Выбор главного элемента

Стандартный метод Гаусса может быть нестабильным, если какие-либо диагональные элементы близки к нулю. Для повышения устойчивости используют модификацию метода с выбором главного элемента:

### Выбор главного элемента по столбцу

На каждом шаге k прямого хода:
1. Находим строку p ≥ k с максимальным по модулю значением |a[p,k]|
2. Если p ≠ k, меняем местами строки k и p в матрице A и векторе b
3. Продолжаем обычный прямой ход

### Выбор главного элемента по всей матрице

Более сложная, но еще более устойчивая стратегия – выбор главного элемента по всей оставшейся подматрице. В этом случае может потребоваться перестановка и столбцов, что усложняет алгоритм.

## Вычислительная сложность

- Прямой ход: O(n³) операций
- Обратный ход: O(n²) операций
- Общая сложность: O(n³) операций

## Реализация в Julia

Ниже представлена реализация метода Гаусса без выбора главного элемента и с выбором главного элемента по столбцу:

```julia
# Метод Гаусса без выбора главного элемента
function gauss_elimination(A::AbstractMatrix, b::AbstractVector)
    n = size(A, 1)
    A_copy = copy(A)
    b_copy = copy(b)
    
    # Прямой ход
    for k = 1:n-1
        for i = k+1:n
            if abs(A_copy[k, k]) < eps()
                error("Нулевой ведущий элемент в строке $k")
            end
            
            factor = A_copy[i, k] / A_copy[k, k]
            
            for j = k:n
                A_copy[i, j] -= factor * A_copy[k, j]
            end
            
            b_copy[i] -= factor * b_copy[k]
        end
    end
    
    # Обратный ход
    x = zeros(n)
    for i = n:-1:1
        sum_val = 0.0
        for j = i+1:n
            sum_val += A_copy[i, j] * x[j]
        end
        
        if abs(A_copy[i, i]) < eps()
            error("Нулевой диагональный элемент при обратном ходе в строке $i")
        end
        
        x[i] = (b_copy[i] - sum_val) / A_copy[i, i]
    end
    
    return x
end

# Метод Гаусса с выбором главного элемента по столбцу
function gauss_elimination_pivot(A::AbstractMatrix, b::AbstractVector)
    n = size(A, 1)
    A_copy = copy(A)
    b_copy = copy(b)
    
    # Вектор перестановок
    p = collect(1:n)
    
    # Прямой ход
    for k = 1:n-1
        # Находим максимальный элемент в текущем столбце
        max_val = abs(A_copy[k, k])
        max_idx = k
        
        for i = k+1:n
            if abs(A_copy[i, k]) > max_val
                max_val = abs(A_copy[i, k])
                max_idx = i
            end
        end
        
        # Проверка на сингулярность
        if max_val < eps()
            error("Матрица близка к сингулярной или сингулярна")
        end
        
        # Меняем местами строки, если нашли лучший ведущий элемент
        if max_idx != k
            # Меняем строки в матрице A
            for j = 1:n
                A_copy[k, j], A_copy[max_idx, j] = A_copy[max_idx, j], A_copy[k, j]
            end
            
            # Меняем элементы в векторе b
            b_copy[k], b_copy[max_idx] = b_copy[max_idx], b_copy[k]
            
            # Запоминаем перестановку
            p[k], p[max_idx] = p[max_idx], p[k]
        end
        
        # Исключение переменных
        for i = k+1:n
            factor = A_copy[i, k] / A_copy[k, k]
            
            for j = k:n
                A_copy[i, j] -= factor * A_copy[k, j]
            end
            
            b_copy[i] -= factor * b_copy[k]
        end
    end
    
    # Обратный ход
    x = zeros(n)
    for i = n:-1:1
        sum_val = 0.0
        for j = i+1:n
            sum_val += A_copy[i, j] * x[j]
        end
        
        if abs(A_copy[i, i]) < eps()
            error("Нулевой диагональный элемент при обратном ходе в строке $i")
        end
        
        x[i] = (b_copy[i] - sum_val) / A_copy[i, i]
    end
    
    # Создаем вектор решения с учетом перестановок (если используется)
    x_original = zeros(n)
    for i = 1:n
        x_original[p[i]] = x[i]
    end
    
    return x
end
```

## Проблемы и особенности метода Гаусса

### 1. Деление на нулевые или малые элементы

Если на каком-то шаге диагональный элемент a[k,k] равен нулю или близок к нулю, то возникает деление на ноль или вычислительная неустойчивость. Решение этой проблемы – использование выбора главного элемента.

### 2. Накопление ошибок округления

При большом числе операций происходит накопление ошибок округления, что может привести к значительной потере точности результата. Частичное решение – использование выбора главного элемента и повышенной точности вычислений.

### 3. Плохо обусловленные системы

Для плохо обусловленных систем (с большим числом обусловленности) погрешность решения может быть существенной. В таких случаях можно:
- Использовать методы с повышенной точностью
- Применять итерационное уточнение решения
- Использовать специализированные методы для плохо обусловленных систем

## Примеры

### Пример 1: Хорошо обусловленная система

Рассмотрим систему:
```
2x₁ + x₂ - x₃ = 8
-3x₁ - x₂ + 2x₃ = -11
-2x₁ + x₂ + 2x₃ = -3
```

В матричной форме:
```
A = [2 1 -1; -3 -1 2; -2 1 2]
b = [8, -11, -3]
```

Решение методом Гаусса:

```julia
A = [2.0 1.0 -1.0; -3.0 -1.0 2.0; -2.0 1.0 2.0]
b = [8.0, -11.0, -3.0]

# Решение без выбора главного элемента
x_gauss = gauss_elimination(A, b)
println("Решение методом Гаусса без выбора главного элемента: ", x_gauss)

# Решение с выбором главного элемента
x_gauss_pivot = gauss_elimination_pivot(A, b)
println("Решение методом Гаусса с выбором главного элемента: ", x_gauss_pivot)

# Проверка решения
println("Невязка: ||Ax - b|| = ", norm(A * x_gauss - b))
```

### Пример 2: Неустойчивая система

Рассмотрим плохо обусловленную систему:
```
10⁻¹⁰x₁ + x₂ = 1
x₁ + x₂ = 2
```

В матричной форме:
```
A = [1e-10 1; 1 1]
b = [1, 2]
```

Решение методом Гаусса:

```julia
A_unstable = [1e-10 1.0; 1.0 1.0]
b_unstable = [1.0, 2.0]

# Решение без выбора главного элемента может быть неустойчивым
try
    x_unstable = gauss_elimination(A_unstable, b_unstable)
    println("Решение методом Гаусса без выбора главного элемента: ", x_unstable)
    println("Невязка: ||Ax - b|| = ", norm(A_unstable * x_unstable - b_unstable))
catch e
    println("Ошибка при решении без выбора главного элемента: ", e.msg)
end

# Решение с выбором главного элемента
x_unstable_pivot = gauss_elimination_pivot(A_unstable, b_unstable)
println("Решение методом Гаусса с выбором главного элемента: ", x_unstable_pivot)
println("Невязка: ||Ax - b|| = ", norm(A_unstable * x_unstable_pivot - b_unstable))

# Сравнение с точным решением
x_exact = [1.0, 1.0]
println("Точное решение: ", x_exact)
println("Ошибка: ||x - x_exact|| = ", norm(x_unstable_pivot - x_exact))
```

## Практические рекомендации

1. **Всегда используйте выбор главного элемента** для повышения устойчивости метода Гаусса.
2. **Масштабируйте уравнения**, если коэффициенты сильно различаются по величине.
3. **Используйте LU-разложение** вместо метода Гаусса, если нужно решить системы с одной матрицей и разными правыми частями.
4. **Применяйте итерационное уточнение** для повышения точности решения плохо обусловленных систем.
5. **Контролируйте невязку** ||Ax - b|| для оценки точности полученного решения.

## Задания для самостоятельной работы

1. Реализуйте метод Гаусса с выбором главного элемента по всей матрице.
2. Исследуйте влияние порядка исключения неизвестных на устойчивость метода Гаусса.
3. Сравните точность решения методом Гаусса с выбором главного элемента и без него для различных типов матриц.
4. Модифицируйте метод Гаусса для работы с прямоугольными матрицами и решения переопределенных систем.
5. Разработайте алгоритм итерационного уточнения решения, полученного методом Гаусса.
6. Исследуйте зависимость ошибки округления от размера системы и числа обусловленности матрицы. 