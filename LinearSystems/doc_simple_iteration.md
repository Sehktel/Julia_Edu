# Метод простой итерации для решения систем нелинейных уравнений

## Теоретическое описание

Метод простой итерации (Fixed-Point Iteration) является одним из основных численных методов для решения систем нелинейных уравнений. Его основная идея заключается в преобразовании исходной системы уравнений к виду, удобному для организации итерационного процесса.

### Математическая формулировка

Рассмотрим систему нелинейных уравнений в общем виде:

$$F(x) = 0$$

где $F: \mathbb{R}^n \rightarrow \mathbb{R}^n$ - нелинейная вектор-функция, $x \in \mathbb{R}^n$ - искомый вектор решения.

Для применения метода простой итерации систему необходимо преобразовать к виду:

$$x = G(x)$$

Это можно сделать различными способами, например:

$$x_{k+1} = x_k - \alpha F(x_k)$$

где $\alpha$ - некоторый параметр релаксации (или демпфирования).

### Алгоритм метода

1. Выбрать начальное приближение $x_0$.
2. Выбрать параметр релаксации $\alpha$.
3. Построить итерационную функцию $G(x) = x - \alpha F(x)$.
4. Повторять итерации $x_{k+1} = G(x_k)$ до достижения заданной точности или максимального числа итераций.

### Условие сходимости

Метод простой итерации сходится, если функция $G(x)$ удовлетворяет условию Липшица с константой $L < 1$ в окрестности решения. Это означает, что для всех $x, y$ из некоторой области:

$$\|G(x) - G(y)\| \leq L \|x - y\|, \quad L < 1$$

На практике это часто проверяется через норму матрицы Якоби итерационной функции:

$$\|J_G(x)\| < 1$$

где $J_G(x)$ - матрица Якоби функции $G(x)$.

### Скорость сходимости

Если выполнено условие сходимости, то метод сходится линейно, т.е. ошибка на каждой итерации уменьшается примерно в одно и то же число раз:

$$\|x_{k+1} - x^*\| \leq L \|x_k - x^*\|$$

где $x^*$ - точное решение.

## Реализация на Julia

```julia
"""
    prepare_iteration_function(f, x₀, α=0.01)

Подготавливает итерационную функцию для метода простой итерации из системы уравнений f(x) = 0.
Используется преобразование x_{k+1} = x_k - α*f(x_k), где α - параметр релаксации.
"""
function prepare_iteration_function(f, x₀, α=0.01)
    # Проверяем значение параметра релаксации
    if α <= 0 || α >= 2
        throw(ArgumentError("Параметр релаксации α должен быть в диапазоне (0, 2)"))
    end
    
    # Возвращаем итерационную функцию: x_{k+1} = x_k - α*f(x_k)
    return x -> x .- α .* f(x)
end

"""
    simple_iteration_solve(f, x₀; α=0.01, max_iter=1000, tol=1e-6, check_condition=true)

Решает систему нелинейных уравнений f(x) = 0 методом простой итерации.
"""
function simple_iteration_solve(f, x₀; α=0.01, max_iter=1000, tol=1e-6, check_condition=true)
    # Подготовка итерационной функции
    g = prepare_iteration_function(f, x₀, α)
    
    # Проверка условия сходимости
    if check_condition
        converges, norm_val = check_convergence(g, x₀)
        if !converges
            @warn "Нарушено условие сходимости. Норма производной: $norm_val > 1"
        end
    end
    
    # Инициализация
    x = copy(x₀)
    errors = Float64[]
    
    for iter in 1:max_iter
        # Вычисление нового приближения
        x_new = g(x)
        
        # Вычисление ошибки
        error = norm(x_new - x) / max(norm(x), 1.0)
        push!(errors, error)
        
        # Проверка сходимости
        if error < tol
            return x_new, true, iter, errors
        end
        
        # Обновление текущего приближения
        x = x_new
    end
    
    # Если метод не сошелся за максимальное число итераций
    return x, false, max_iter, errors
end
```

## Примеры использования

### Пример 1: Система двух нелинейных уравнений

Рассмотрим систему:
```
x^2 + y^2 = 4
x*y = 1
```

В виде $F(x) = 0$:
```
F(x,y) = [x^2 + y^2 - 4, x*y - 1]
```

```julia
function example_system(x)
    return [
        x[1]^2 + x[2]^2 - 4,  # x^2 + y^2 - 4 = 0
        x[1]*x[2] - 1         # x*y - 1 = 0
    ]
end

initial_guess = [1.0, 1.0]
result, converged, iterations, errors = simple_iteration_solve(
    example_system, initial_guess, α=0.1, max_iter=1000, tol=1e-6
)

println("Решение: $result")
println("Сходимость: $converged")
println("Количество итераций: $iterations")
println("Конечная ошибка: $(errors[end])")
```

### Визуализация сходимости

```julia
using Plots

# Построение графика сходимости
plot(1:length(errors), errors, 
     xlabel="Итерации", ylabel="Ошибка", 
     title="Сходимость метода простой итерации", 
     legend=false, yscale=:log10)
```

## Преимущества и недостатки

### Преимущества
- Простота реализации и понимания алгоритма
- Небольшие вычислительные затраты на каждой итерации
- Применим к широкому классу нелинейных систем

### Недостатки
- Медленная сходимость (линейная)
- Требуется выбор хорошего начального приближения
- Необходим правильный подбор параметра релаксации $\alpha$
- Может расходиться, если не выполнено условие сходимости

## Практические рекомендации

1. **Выбор параметра релаксации**: Параметр $\alpha$ сильно влияет на скорость сходимости. Слишком малое значение приводит к медленной сходимости, слишком большое - к расходимости. Рекомендуется начинать с малых значений (0.01-0.1) и постепенно увеличивать, если метод сходится.

2. **Начальное приближение**: Выбирайте начальное приближение максимально близко к предполагаемому решению. Это увеличивает шансы на сходимость.

3. **Проверка условия сходимости**: Всегда проверяйте условие сходимости перед запуском метода, чтобы избежать бесконечных циклов или ложных решений.

4. **Комбинирование с другими методами**: Метод простой итерации часто используется как часть более сложных алгоритмов или в сочетании с другими методами для улучшения сходимости.

## Заключение

Метод простой итерации - это базовый итерационный метод для решения систем нелинейных уравнений. Несмотря на свою простоту, он может быть эффективен для определенных классов задач, особенно когда начальное приближение достаточно близко к решению. В более сложных случаях рекомендуется использовать более продвинутые методы, такие как метод Ньютона. 